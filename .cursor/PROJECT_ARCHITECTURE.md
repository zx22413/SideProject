# 靈魂食堂專案架構報告

> **生成日期**: 2026-01-25  
> **專案狀態**: V4.4（五味系統與劇情深化完成）  
> **文件總數**: 56 個 Markdown（+3 份新文件） + 5 個 GAS 代碼  
> **整理狀態**: ✅ 文件整合完成（2026-01-25）

---

## 📊 專案進度時間軸

### 2026-01-21：UX 優化與 Day 1 動態系統（開發進度）

**主要成果**（從 git commit `95458ca` 確認）：
- ✅ UX 全面優化（Loading Animation 35 處、Message Action 導入）
- ✅ Day 1 動態話題系統實現（重大突破）
- ✅ Bug 修正（4 個關鍵問題）
- ✅ 代碼行數：~3,488 行（+200 行）

**相關文件**：
- `00-工作區/工作報告_2026-01-21_UX全面改進.md`
- `00-工作區/主 Backlog_2026-01-15.md`（更新 P0 任務狀態）
- `00-核心企劃/當前專案_靈魂食堂/靈魂食堂：最終開發執行企劃書.md`（更新至 V4.3）

---

### 2026-01-22：文件整理完成（知識管理進度）

**主要成果**（三階段整理）：
- ✅ 第一階段：README 整合 + 文件歸檔（-12 份）
- ✅ 第二階段：驗證/研究/開發整理（-18 份）
- ✅ 第三階段：連結清理 + 素材整理（-8 份）
- ✅ 總計：85 份 → 55 份（-35%）
- ✅ Obsidian Graph 清潔度：70% → 100%

**相關文件**：
- `00-工作區/工作報告_2026-01-22_文件整理完成.md`
- `.cursor/PROJECT_ARCHITECTURE.md`（本文件）

---

### 2026-01-24：五味系統 + 文件整合（開發進度）

**主要成果**：
- ✅ 五味數值系統實作完成（裁縫手藝調整、新標籤加入）
- ✅ 縱向延伸話題實作（Day 1 你的手延伸、Day 2 那個夢/你怎麼來的延伸）
- ✅ 甜/苦路線設計完成（甜味過重、苦味過重路線可達成）
- ✅ 文件整合：`縱向話題延伸`、`話題調整建議` 整合到 `田中太郎_橫向與五味結構.md`
- ✅ 文件總數：55 份 → 53 份（-2 份）

**相關文件**：
- `00-核心企劃/當前專案_靈魂食堂/田中太郎_橫向與五味結構.md`（已整合）
- `00-工作區/文件整理計劃_2026-01-24.md`

---

### 2026-01-25：五味系統與劇情深化完成（開發進度）

**主要成果**：
- ✅ 五味數值系統完整實作（`MEMORY_FLAVOR_MAP`、`calculateFlavorBalance()`、`determineEnding()`）
- ✅ 縱向延伸話題系統完成（Day 1「你的手」延伸、Day 2「那個夢」「你怎麼來的」延伸）
- ✅ 人物紀傳撰寫完成（`田中太郎_人生紀實.md` 1,127 行、`整合建議.md` 634 行、`劇情流程圖.md` 427 行）
- ✅ 代碼行數：~3,653 行 → ~4,231 行（五味料理版）
- ✅ Bug 修正累計 12+ 個（LINE API 訊息限制、競爭條件、Phase 錯誤等）
- ✅ 文件總數：53 份 → 56 份（+3 份新文件）

**相關文件**：
- `00-工作區/工作報告_2026-01-25_五味系統與劇情深化完成.md`
- `02-劇本設計/田中太郎_人生紀實.md`（新建）
- `02-劇本設計/田中太郎_人生紀實整合建議.md`（新建）
- `02-劇本設計/田中太郎劇情流程圖.md`（新建）
- `01-開發實驗/程式碼/靈魂食堂_田中太郎_五味料理版.gs`（主代碼更新）

---

### 2026-01-26：劇本昇華三痛點完成（V4.5 開發進度）⭐ 最新

**主要成果**：
- ✅ 劇本昇華三痛點完成（翻譯者/裂痕/時代感）
- ✅ 新增 3 個記憶標籤：`失語`、`缺席的典禮`、`空蕩的店`
- ✅ 新增 2 個延伸話題：`twilight_artisan`（空蕩的店）、`ceremony_rift`（缺席典禮）
- ✅ 撫慰鹹粥增強：翻譯者概念（雪子作為溝通介面）
- ✅ 代碼行數：~4,231 行 → ~4,350 行（劇本昇華版）
- ✅ 版本號更新：V4.4 → V4.5

**設計亮點**：
- **翻譯者概念**：妻子雪子是田中的「翻譯介面」，她走後他失去表達愛的能力
- **裂痕事件**：入學典禮缺席是父女決裂的「原爆點」，核心台詞：「那件西裝很完美。但我永遠失去了我最重要的觀眾。」
- **時代感**：職人被時代淘汰的孤獨，解釋他為何退縮到閣樓

**相關文件**：
- `00-工作區/工作報告_2026-01-26_劇本昇華三痛點完成.md` ⭐ 最新
- `01-開發實驗/程式碼/靈魂食堂_田中太郎_五味料理版.gs`（V4.5 更新）
- `00-核心企劃/當前專案_靈魂食堂/靈魂食堂：最終開發執行企劃書.md`（V4.5 更新）

---

## 📊 文件整理成果總覽

### 文件數量變化

| 階段 | 操作 | 文件總數 | 階段變化 | 累積變化 | 完成日期 |
|------|------|---------|---------|---------|---------|
| **整理前** | - | 85 份 | - | - | - |
| **第一階段** | README 整合 + 文件歸檔 | 73 份 | -12 份 | -14% | 2026-01-22 |
| **第二階段** | 驗證/研究/開發整理 | 55 份 | -18 份 | -35% | 2026-01-22 |
| **第三階段** | 連結清理 + 素材整理 | **55 份** | -8 份（含歸檔） | **-35%** | 2026-01-22 |
| **第四階段** | 劇本設計文件整合 | **53 份** | -2 份 | **-38%** | 2026-01-24 |
| **第五階段** | 人物紀傳撰寫 | **56 份** | +3 份 | **-34%** | 2026-01-25 |

**最終成果**：從 **85 份減少到 56 份**（整理後新增 3 份），淨減少 **29 份文件（-34%）**

---

### 品質提升

| 維度 | 整理前 | 整理後 | 改善幅度 |
|------|--------|--------|---------|
| **空白文件** | 3 份 | 0 份 | -100% |
| **模板文件** | 21 份 | 0 份 | -100% |
| **重複文件** | 5 份 | 0 份 | -100% |
| **空連結** | ~30 個 | 0 個 | -100% |
| **孤立文件** | 8 份 | 0 份 | -100% |
| **Obsidian Graph 清潔度** | ~70% | **100%** | +43% |

---

## 🏗️ 文件分層架構（Tier System）✅

### 📌 Tier 1：核心真理源（Single Source of Truth）

**定義**：專案的「唯一真理」，所有決策的最終依據  
**狀態**：✅ 已確立並保持最新

| 文件路徑 | 職責 | 更新頻率 | 影響範圍 | 狀態 |
|---------|------|---------|---------|------|
| `00-核心企劃/當前專案_靈魂食堂/靈魂食堂：最終開發執行企劃書.md` | 專案全貌、世界觀、核心機制、故事結構、話題設計、五味對照 | 每週 | 全專案 | ✅ V4.4 |
| `00-工作區/主 Backlog_2026-01-15.md` | 任務清單、優先級、Sprint 進度 | 每週 | 開發流程 | ✅ 最新 |
| `01-開發實驗/專案實作對照表.md` | 企劃與代碼的映射關係 | 每週 | 技術實作 | ✅ 最新 |
| `00-核心企劃/開發決策鏈.md` | 重大決策的記錄與考古 | 按需 | 決策追溯 | ✅ 最新 |

**Obsidian 連結標籤**：`#tier1/核心`

---

### 📝 Tier 2：動態追蹤（Daily/Weekly Updates）

**定義**：記錄「我們現在在哪」、「下一步要做什麼」  
**狀態**：✅ 最新報告已更新至 2026-01-22

#### A. 工作報告（每日）

| 文件 | 狀態 | 說明 |
|------|------|------|
| `00-工作區/工作報告_2026-01-25_五味系統與劇情深化完成.md` | ✅ 最新 | 五味系統與劇情深化完成（25日） |
| `00-工作區/工作報告_2026-01-23_Day2-3動態系統完成.md` | ✅ 參考 | Day 2-3 動態系統完成（23日） |
| `00-工作區/文件整理計劃_2026-01-24.md` | ✅ 參考 | 文件整合計劃（24日） |
| `00-工作區/archive-2026-01/` | ✅ 歸檔 | 歷史工作報告已歸檔 |

**規則**：
- 工作報告以日期命名：`工作報告_YYYY-MM-DD_主題.md`
- 超過 7 天的報告移到 `00-工作區/archive-2026-01/`
- 工作報告必須包含 `[[連結]]` 到受影響的 Tier 1 文件

#### B. 階段性報告

| 文件 | 狀態 | 用途 |
|------|------|------|
| `00-工作區/架構診斷報告_2026-01-15.md` | ✅ 參考 | 轉型斷層分析 |
| `00-工作區/重構完成報告_2026-01-17.md` | ✅ 參考 | 數據結構重構總結 |
| `00-工作區/專案整理完成報告_2026-01-17.md` | ✅ 參考 | 文件整理成果 |
| `00-工作區/工作報告_2026-01-22_文件整理完成.md` | ✅ 最新 | 三階段整理總結（22日完成） |

**Obsidian 連結標籤**：`#tier2/追蹤`

---

### 📚 Tier 3：參考資料（Reference Only）

**定義**：已經穩定、不常變動的文件，作為查閱參考  
**狀態**：✅ 已精簡至高價值文件（~40 份）

#### 3.1 代碼與部署（7 份）✅

| 文件 | 類型 | 用途 | 優先級 |
|------|------|------|--------|
| `靈魂食堂_田中太郎_五味料理版.gs` | 代碼 | ⭐ 主代碼（V4.4） | P0 |
| `靈魂食堂_畫鬼腳MVP.gs` | 代碼 | 參考版本 | P2 |
| `config.template.gs` | 配置 | 配置模板 | P1 |
| `部署與開發指南.md` | 文檔 | ⭐ 整合版（通用） | P0 |
| `田中太郎版部署指南.md` | 文檔 | 專用版（快速部署） | P1 |
| `敏感文件同步指南.md` | 文檔 | 敏感信息處理 | P1 |
| `重構驗證報告_2026-01-16.md` | 報告 | 重構驗證記錄 | P2 |

**兩個部署指南的差異**：
- **部署與開發指南.md**（442 行）：通用指南，適合新手，包含完整 UX 設計原則
- **田中太郎版部署指南.md**（311 行）：專用指南，適合熟手，包含差異對比和優化建議

---

#### 3.2 劇本設計（3 份）✅

| 文件 | 版本 | 狀態 | 用途 |
|------|------|------|------|
| `Guest1_田中太郎_重構版_神秘感優先.md` | V4.4 | ⭐ 當前劇本 | 主劇本 |
| `Guest1_田中太郎_MVP擴充版.md` | V4.2 | 參考 | 過渡版參考 |
| `靈魂考古_3日邏輯鏈.md` | - | 參考 | 劇本框架 |

**已歸檔**：
- ✅ `Guest1_失憶老裁縫_完整劇本.md`（初版已歸檔至 `歷史歸檔_V1.0-V1.3/`）

---

#### 3.3 研究分析（5 份高價值 + 6 份已歸檔）✅

**保留的高價值文件**：

| 文件 | 價值 | 用途 | 行數 |
|------|------|------|------|
| `靈魂食堂企劃重構.md` | ⭐⭐⭐⭐⭐ | 完整企劃（55-212 頁） | ~2000 |
| `Line OA 文字遊戲 MVP 開發指南.md` | ⭐⭐⭐⭐⭐ | 技術指南 | ~1500 |
| `企劃書與Bird Alone結合探討.md` | ⭐⭐⭐⭐ | 情感機制分析 | ~800 |
| `孤鳥劇情解析與文字遊戲發想.md` | ⭐⭐⭐⭐ | Bird Alone 深度分析 | ~600 |
| `紅弦俱樂部劇情攻略與分析.md` | ⭐⭐⭐ | 話題選單參考 | ~400 |

**已歸檔**（`archive-research/`）：
- ✅ `理論 & 假設.md`（雲寶時代）
- ✅ `競品分析：Finch.md`（雲寶時代）
- ✅ `寵物日記載體轉換評估.md`（雲寶時代）
- ✅ `數位印記日記App設計.md`（雲寶時代）
- ✅ 等 6 份雲寶時代研究

**已刪除**：
- ❌ `商業邏輯.md`、`競品參考.md`、`SumOne.md`、`黃昏旅店分析計畫.md`

---

#### 3.4 驗證流程（2 份整合版）✅

**整合成果**：17 份 → 2 份（-88%）

| 文件 | 行數 | 內容 | 狀態 |
|------|------|------|------|
| `驗證流程總覽.md` | ~400 | 所有驗證對象與方式的完整定義 | ✅ 整合版 |
| `驗證記錄.md` | ~300 | V1.1（雲寶）+ V4.3（靈魂食堂）實際記錄 | ✅ 整合版 |

**已刪除**：
- ❌ 15 份驗證流程模板文件（對象 5 份 + 方式 7 份 + 記錄 3 份）

---

#### 3.5 資源素材（4 份原子筆記 + 圖片）✅

**保留的高價值原子筆記**：

| 文件 | 價值 | 主題 | 行數 |
|------|------|------|------|
| `產品規劃轉變脈絡_從雲寶到靈魂食堂.md` | ⭐⭐⭐⭐⭐ | 轉型決策完整考古 | ~420 |
| `技術成本_非即時制設計的優勢.md` | ⭐⭐⭐⭐ | 非即時制設計哲學 | ~130 |
| `敘事機制_載體與體驗的裂縫.md` | ⭐⭐⭐⭐ | 產品裂縫診斷 | ~84 |
| `開發哲學_成本優先原則.md` | ⭐⭐⭐ | 成本優先原則 | ~60 |
| `圖片/` | - | 圖片素材（12 張） | - |

**已刪除**：
- ❌ `輸入載體/` 資料夾（7 個模板文件全部刪除）
- ❌ `輸入形式.md`（空索引頁）
- ❌ `驗證方式以及回饋模型.md`（與新文件重疊）

**成果**：12 份 → 4 份（-67%），所有空連結已清理

---

### 🗄️ Tier 4：歷史歸檔（長期保存）

**定義**：已經過時但有歷史價值的文件，不常查閱  
**狀態**：✅ 已完成歸檔（~25 份）

#### 已完成歸檔結構 ✅

```
00-核心企劃/
└── 歷史歸檔_V1.0-V1.3/ ✅
    ├── 企劃書_V1.0~V1.3.md（13 份雲寶企劃）
    └── 開發日誌/ ✅
        └── 開發日誌_V1.2~V1.3.md（5 份開發日誌）

00-工作區/
└── archive-2026-01/ ✅
    └── 工作報告_2026-01-18~20.md（12 份過時報告）

01-開發實驗/
└── 程式碼/
    └── archive-versions/ ✅
        ├── 程式碼.gs（舊版）
        └── 程式碼_GAS相容版.gs（舊版）

02-研究分析/
└── archive-research/ ✅
    └── 雲寶時代研究（6 份）
```

**歸檔總數**：~25 份歷史文件

**Obsidian 連結標籤**：`#tier4/歸檔`

---

## 🎯 AI 閱讀優先級指南 ✅

**專案狀態**：文件架構已完全清晰，Obsidian Graph 100% 清潔

### 情境 1：快速了解專案（5 分鐘）

**必讀**（按順序）：
1. `README.md`（專案總覽）
2. `靈魂食堂：最終開發執行企劃書.md`（核心企劃）
3. `主 Backlog_2026-01-15.md`（當前進度）

### 情境 2：開始開發任務（10 分鐘）

**必讀**：
1. Tier 1 的 4 個核心文件
2. `工作報告_2026-01-25_五味系統與劇情深化完成.md`（25日：五味系統 + 劇情深化）⭐ 最新
3. `工作報告_2026-01-23_Day2-3動態系統完成.md`（23日：Day 2-3 動態系統）
4. `工作報告_2026-01-21_UX全面改進.md`（21日：UX 優化 + Day 1 動態系統）
5. `專案實作對照表.md`（代碼映射）
6. `部署與開發指南.md`（技術實作）

### 情境 3：理解決策脈絡（30 分鐘）

**必讀**：
1. Tier 1 + Tier 2 全部
2. `開發決策鏈.md`（決策追溯）
3. `產品規劃轉變脈絡_從雲寶到靈魂食堂.md`（轉型考古）
4. `架構診斷報告_2026-01-15.md`（問題診斷）

### 情境 4：深度研究（1 小時+）

**閱讀順序**：
1. Tier 1（核心真理）
2. Tier 2（最新進展）
3. Tier 3（參考資料，按需查閱）
4. Tier 4（歷史歸檔，僅在需要考古時查閱）

---

## 🔗 Obsidian 連結規範 ✅

**狀態**：所有連結已清理，0 個空連結

### 規範 1：使用相對路徑連結 ✅

**推薦格式**：
```markdown
[[../../00-核心企劃/開發決策鏈]]
[[../02-研究分析/靈魂食堂企劃重構]]
```

**避免使用**：
```markdown
[[開發決策鏈]]  # ❌ 可能產生歧義
```

---

### 規範 2：連結命名規範 ✅

**文件命名**：
- 使用描述性名稱
- 避免空格（使用底線 `_` 或中文）
- 範例：`工作報告_2026-01-22_UX全面改進.md`

**連結文字**：
```markdown
詳見 [[工作報告_2026-01-22_UX全面改進]]
參考 [[部署與開發指南]]
```

---

### 規範 3：避免空連結 ✅

**檢查清單**：
- ✅ 連結的目標文件是否存在
- ✅ 路徑是否正確
- ✅ 文件名是否拼寫正確

**當前狀態**：
- ✅ 所有空連結已清理（~30 個 → 0 個）
- ✅ 所有連結都可點擊
- ✅ Obsidian Graph 100% 清潔

---

## 📝 工作日記驅動更新邏輯 ✅

**狀態**：工作報告與核心文件已同步至 2026-01-25

### 核心理念

工作日記（如 `工作報告_2026-01-25_五味系統與劇情深化完成.md`、`工作報告_2026-01-23_Day2-3動態系統完成.md`）是專案的「心跳」，它應該自動驅動其他文件的更新。

### 更新流程

```mermaid
graph TD
    A[寫工作日記] --> B{影響哪些 Tier 1 文件?}
    B -->|企劃變更| C[更新企劃書]
    B -->|任務進度| D[更新 Backlog]
    B -->|技術實作| E[更新專案實作對照表]
    B -->|決策記錄| F[更新開發決策鏈]
    C --> G[在工作日記中標記 [[連結]]]
    D --> G
    E --> G
    F --> G
    G --> H[工作日記歸檔規則]
    H -->|超過 7 天| I[移至 archive-2026-01/]
```

### 自動化提示

**工作日記模板**（建議）：
```markdown
# 工作報告_YYYY-MM-DD_主題

## ✅ 已完成
- 完成 [具體任務]
  - 影響文件：[[主 Backlog]]、[[靈魂食堂企劃書]]

## 🔄 進行中
- Day 2-3 動態系統擴展

## 📝 關鍵突破
- 動態話題選單設計完成

## 🔗 受影響的核心文件
- [[主 Backlog_2026-01-15]] - 更新 P0 任務狀態
- [[靈魂食堂：最終開發執行企劃書]] - 新增動態系統原則
```

---

## 📈 各資料夾整理成果

| 資料夾 | 整理前 | 整理後 | 改善 | 備註 |
|--------|--------|--------|------|------|
| **根目錄** | 3 份空白 | 1 份 | **-67%** | 保留 README.md + 1 份技術成本 |
| **00-工作區** | 12 份 | 5 份（+歸檔） | **-58%** | 保留核心，歸檔歷史報告 |
| **01-開發實驗** | 6 份 | 1 份（+歸檔） | **-83%** | 保留專案實作對照表 |
| **02-劇本設計** | 4 份 | 6 份（+歸檔） | **+50%** | 保留重構版劇本 + 新增人物紀傳（3份） |
| **02-研究分析** | 14 份 | 5 份（+歸檔） | **-64%** | 保留高價值研究 |
| **03-驗證流程** | 17 份 | 2 份 | **-88%** | 整合為 2 份完整文件 |
| **04-資源素材** | 12 份 | 4 份 | **-67%** | 刪除所有模板 |

---

## 🎉 整理完成總結 ✅

### 已完成（2026-01-22 文件整理日）

**注意**：以下為 2026-01-22 完成的文件整理工作。21 日的開發進度（UX 優化 + Day 1 動態系統）請參考 `00-工作區/工作報告_2026-01-21_UX全面改進.md`

#### 第一階段：README 整合與文件歸檔（2026-01-22）
- ✅ 刪除 3 份重複 README
- ✅ 創建整合部署指南
- ✅ 更新根目錄 README 至 V4.3
- ✅ 創建 `PROJECT_ARCHITECTURE.md`

#### 第二階段：驗證/研究/開發整理（2026-01-22）
- ✅ 刪除 22 份空白/低價值文件
- ✅ 創建 2 份驗證流程整合文件
- ✅ 歸檔 11 份歷史文件

#### 第三階段：連結與素材清理（2026-01-22）
- ✅ 刪除 8 份模板和重疊文件
- ✅ 清理所有空連結（~30 個 → 0 個）
- ✅ 更新 README 專案結構
- ✅ 批量更新所有日期至 2026-01-22

---

### 整理成果數據

| 指標 | 成果 |
|------|------|
| **文件總數** | 85 → 55（-35%） |
| **刪除文件** | 30 份 |
| **歸檔文件** | 23 份 |
| **空連結** | ~30 → 0（-100%） |
| **Obsidian Graph 清潔度** | 70% → 100%（+43%） |
| **專案架構** | 完全清晰（Tier 1-4） |

---

### 帶來的好處

#### 1. 降低認知負荷
- **整理前**：85 個文件，不知道哪些重要
- **整理後**：55 個文件，Tier 1-4 結構清晰

#### 2. 提高維護效率
- **整理前**：文件分散，更新時容易遺漏
- **整理後**：文件集中，更新一次即可

#### 3. 更好的 AI 協作
- **整理前**：AI 需要讀取 85 個文件
- **整理後**：AI 只需讀取 55 個有效文件

#### 4. Obsidian 使用體驗提升
- **整理前**：Graph 充滿空連結節點
- **整理後**：Graph 只顯示有效連結，清晰可導航

---

## 🚀 未來優化建議

### 立即行動（已完成）✅
- ✅ 建立完整的文件分層架構
- ✅ 整合驗證流程文件
- ✅ 刪除低價值文件
- ✅ 歸檔歷史文件
- ✅ 清理所有空連結
- ✅ 更新 README 至 V4.3

### 未來優化（有空再做）
1. [ ] 建立 Agent Skill：`project-cleanup`（自動化文件整理）
2. [ ] 建立 Agent Skill：`daily-journal-sync`（工作日記驅動更新）
3. [ ] 建立 Agent Skill：`archive-detector`（自動檢測可歸檔文件）
4. [ ] 建立 Cursor Rule：Obsidian 連結規範
5. [ ] 定期回顧 Tier 2 文件，決定是否歸檔

---

## 📚 相關文件索引

### 整理相關
- `00-工作區/工作報告_2026-01-22_文件整理完成.md` - 三階段整理總結

### 核心文件
- `README.md` - 專案總覽
- `00-核心企劃/當前專案_靈魂食堂/靈魂食堂：最終開發執行企劃書.md` - 完整企劃
- `00-工作區/主 Backlog_2026-01-15.md` - 任務清單
- `01-開發實驗/專案實作對照表.md` - 代碼映射

---

## 🤖 Cursor AI 配置指南

### `.cursor` 資料夾說明

**定義**：Cursor 的專案級配置目錄，用於存放 AI 行為設定、規則和技能。

#### 目錄結構

```
.cursor/
├── rules/              # AI 行為規則（.mdc 檔案）
├── skills/             # Agent Skills（專案級）
│   └── obsidian-skills/  # ✅ 已安裝
│       ├── obsidian-markdown/
│       ├── obsidian-bases/
│       └── json-canvas/
└── PROJECT_ARCHITECTURE.md  # 本文件（架構總覽）
```

---

### 📋 Rules vs Skills 差異

| 特性 | Rules | Skills |
|------|-------|--------|
| **用途** | 定義 AI 行為規範 | 提供可執行的工作流程 |
| **格式** | `.mdc` (Markdown) | `SKILL.md` + 可選腳本 |
| **觸發方式** | Always / Auto / Manual | Agent 主動選擇或用戶調用 |
| **範例** | "永遠使用 Obsidian 連結格式" | "執行文件整理流程" |

---

### 🎯 規則（Rules）配置

#### 規則類型

1. **Always**：自動包含在所有 AI 對話中
2. **Auto Attached**：當檔案符合特定 glob pattern 時自動包含
3. **Agent Requested**：AI 可自行選擇是否使用（需要描述）
4. **Manual**：需明確用 `@ruleName` 調用

#### 建議建立的規則

```
.cursor/rules/
├── obsidian-linking.mdc          # Obsidian 連結規範（Always）
├── work-journal-format.mdc       # 工作日記格式（Auto Attached: 00-工作區/*.md）
└── commit-message-standard.mdc   # Commit Message 標準（Agent Requested）
```

---

### 🛠️ 技能（Skills）配置

#### 已安裝的 Skills

**Obsidian Skills**（by kepano）
- ✅ 安裝位置：`.cursor/skills/obsidian-skills/`
- 📦 安裝方式：
  ```bash
  cd .cursor/skills
  git clone https://github.com/kepano/obsidian-skills.git obsidian-skills
  ```
- ⚠️ **注意**：此目錄已加入 `.gitignore`（外部依賴，不推送至 Git）
- **功能**：
  - `obsidian-markdown`：建立和編輯 Obsidian Flavored Markdown
  - `obsidian-bases`：處理 Obsidian Bases (`.base` 檔案)
  - `json-canvas`：處理 JSON Canvas (`.canvas` 檔案)
- **用途**：確保 AI 正確處理 Obsidian 的雙向連結 `[[連結]]` 格式

#### 建議開發的自訂 Skills

基於本專案的工作流程，建議開發以下 Skills：

##### 1. `daily-journal-sync` Skill
```
.cursor/skills/daily-journal-sync/
├── SKILL.md
└── README.md
```
**功能**：
- 讀取當日工作報告
- 自動更新相關 Tier 1 文件（企劃書、Backlog、專案實作對照表）
- 檢查並更新雙向連結
- 建議可歸檔的舊報告

**觸發時機**：
- 完成工作報告後
- 用戶使用 `/sync-journal` 命令

##### 2. `project-cleanup` Skill
```
.cursor/skills/project-cleanup/
├── SKILL.md
└── README.md
```
**功能**：
- 掃描專案文件，識別低價值/重複/空白文件
- 檢測空連結和孤立文件
- 生成整理建議報告
- 執行檔案移動/刪除（需用戶確認）

**觸發時機**：
- 定期維護（每週/每月）
- Obsidian Graph 變得混亂時

##### 3. `archive-detector` Skill
```
.cursor/skills/archive-detector/
├── SKILL.md
└── README.md
```
**功能**：
- 自動檢測超過 7 天的工作報告
- 識別 V1.0-V1.3 時代的舊文件
- 建議歸檔路徑
- 更新所有引用該文件的連結

**觸發時機**：
- 每次新增工作報告時
- 用戶使用 `/check-archive` 命令

##### 4. `obsidian-link-validator` Skill
```
.cursor/skills/obsidian-link-validator/
├── SKILL.md
└── README.md
```
**功能**：
- 掃描所有 Markdown 文件的 `[[連結]]`
- 檢測空連結（目標不存在）
- 檢測重複連結
- 生成修復建議

**觸發時機**：
- 文件整理後
- Commit 前檢查

---

### 🌐 外部資源與安裝

#### Agent Skills 資源庫

1. **官方標準庫**
   - [Agent Skills 官網](https://agentskills.io)
   - 超過 63,000+ 技能可參考

2. **社群資源**
   - [Awesome Claude Skills](https://github.com/VoltAgent/awesome-claude-skills)（3.7k stars）
   - [Ultimate Agent Skills Collection](https://github.com/ZhanlinCui/Ultimate-Agent-Skills-Collection)（40+ 高品質技能）

3. **Obsidian 專用**
   - [Obsidian Skills by kepano](https://github.com/kepano/obsidian-skills)（✅ 已安裝）

#### 全域 vs 專案級安裝

```bash
# 專案級（只在此專案使用）
.cursor/skills/          # ✅ 當前使用

# 全域級（所有專案使用）
~/.cursor/skills/        # 適合通用技能
```

---

### 📝 Skill 開發格式

#### 標準 `SKILL.md` 結構

```markdown
---
description: 一行描述這個技能做什麼
tags: [tag1, tag2]
version: 1.0.0
---

# Skill Name

## Description
詳細說明這個技能的功能和使用場景。

## When to Use
- 觸發條件 1
- 觸發條件 2
- 觸發條件 3

## How It Works
1. 步驟 1：做什麼
2. 步驟 2：做什麼
3. 步驟 3：做什麼

## Examples

### Example 1: 場景名稱
\`\`\`
範例代碼或操作
\`\`\`

### Example 2: 場景名稱
\`\`\`
範例代碼或操作
\`\`\`

## Dependencies
- 必須的檔案或工具
- 需要的其他 Skills

## Notes
- 注意事項 1
- 注意事項 2
```

---

### 🚀 下一步行動

#### 立即行動（優先級 P0）
1. ✅ 安裝 Obsidian Skills（已完成）
2. ✅ 建立 `obsidian-linking.mdc` Rule（Always 模式）
3. ✅ 開發 `daily-journal-sync` Skill（最常用）

#### 短期行動（優先級 P1）
1. ✅ 建立 `work-journal-format.mdc` Rule
2. [ ] 開發 `archive-detector` Skill
3. [ ] 測試並迭代 Skills

#### 中期行動（優先級 P2）
1. [ ] 開發 `project-cleanup` Skill
2. [ ] 開發 `obsidian-link-validator` Skill
3. [ ] 建立 `commit-message-standard.mdc` Rule
4. [ ] 探索其他有用的社群 Skills

---

### 💡 使用建議

#### 開發工作流程
1. **工作報告完成後**：
   ```
   /sync-journal  # 觸發 daily-journal-sync Skill
   ```

2. **準備 Commit 前**：
   ```
   /check-archive  # 觸發 archive-detector Skill
   /validate-links # 觸發 obsidian-link-validator Skill
   ```

3. **定期維護（每週/每月）**：
   ```
   /project-cleanup  # 觸發 project-cleanup Skill
   ```

#### AI 自動行為
- **編輯 Markdown 時**：Obsidian Skills 自動啟用
- **查看工作區檔案時**：work-journal-format Rule 自動套用
- **任何時候**：obsidian-linking Rule 永遠生效

---

**文件狀態**：✅ 完整版（含 AI 配置指南 + 第一個自訂 Skill）  
**維護者**：專案負責人  
**最後更新**：2026-01-25  
**下次更新**：完成更多 Skills 或優化現有 Skill 後
