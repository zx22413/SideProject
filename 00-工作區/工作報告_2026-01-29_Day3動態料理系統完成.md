# 靈魂食堂 - Day 1-3 料理演出動態化完成報告

> **日期**：2026-01-29 ~ 01-30  
> **類型**：開發  
> **狀態**：🔄 已部署，待測試

---

## 📋 工作總結

### ✅ 已完成（V4.10 - Day 1-2 料理演出動態化）

#### 1. 統一「有啥食材顯示啥」設計原則
- ✅ 參考 Day 3 的動態顯示邏輯
- ✅ 從玩家實際收集的記憶中，篩選出與該料理相關的記憶來顯示
- ✅ 解決「看到自己沒收集的記憶」的困惑問題

#### 2. Day 1 熱茶演出動態化
- ✅ 修改 `getDay1CookingTea_Part1(state)` 函數
- ✅ 根據實際收集的記憶動態顯示：針/縫線/寒冷/寧靜/陪伴
- ✅ 不同記憶有不同視覺描述（藍色霧氣/銀色光芒/金色絲線/柔和暖光）

#### 3. Day 1 熱湯演出動態化
- ✅ 修改 `getDay1CookingSoup_Part1(state)` 函數
- ✅ 根據實際收集的記憶動態顯示：雨聲/失憶/迷茫

#### 4. Day 2 蜜汁燉菜演出動態化
- ✅ 修改 `getDay2CookingResult(state)` 函數
- ✅ 移除錯誤的「寒冷」（不是必要食材）
- ✅ 只顯示蜜糖笑容/眼淚

#### 5. Day 2 苦辛醒神湯演出動態化 + Flex Card
- ✅ 修改 `getDay2CookingResult_苦辛(state)` 函數
- ✅ 根據實際收集的記憶動態顯示：執念/雪/死亡
- ✅ 記憶劇場改為 Flex Card（閣樓場景 + 雪中場景）

#### 6. 新增「料理食譜系統」結構設計庫
- ✅ 在企劃書新增「五-A」章節
- ✅ 三日料理對照表（解鎖條件 + 相關記憶池 + 實作函數）
- ✅ 新增 Guest 時的檢查清單

---

### ✅ 已完成（V4.9 - Day 3 動態料理系統）

#### 1. Day 3 最終料理動態化（V4.9）
- ✅ 修改 `getDay3CookingStart(state)` 函數
  - 根據五味傾向動態決定料理名稱：
    - 🍬 甜味過重 → 糖霜幻景拼盤
    - 🦴 苦味過重 → 千針冷骨湯
    - 🐟 平衡 → 百味蜜汁炙燒魚
  - 只顯示玩家「實際收集」的食材（不再顯示固定配方）
  - 按鈕文字動態化（「製作 [料理名稱]」）
  - 新增動態黑貓評論

#### 2. 苦味結局真相獨白修正
- ✅ 修改 `getTruthMonologue("ENDING_BITTER")` 函數
  - 核心概念改為「職人的徒勞」
  - 新版文本：
    - 「那件婚紗...真的很美。是我這輩子最好的作品。」
    - 「但是...那又怎樣呢？」
    - 「它現在躺在漆黑的櫃子裡。而我...倒在雪地裡。」
    - 「沒人知道我做好了。也沒人會來穿它了。」
  - 設計理念：真正的苦，不是「做不到」，而是「做到了，卻沒有意義」

#### 3. Day 3 料理演出動態化
- ✅ 修改 `getDay3CookingProcess_Part1(state)` - 根據結局類型調整做菜演出
- ✅ 修改 `getDay3CookingProcess_Part2(state)` - 根據結局類型調整完成文案
- ✅ 修改 `getDay3CookingMemoryCard(state)` - 動態黑貓評論與卡片顏色

#### 4. handleDay3Cooking 更新
- ✅ 傳遞 state 給各函數
- ✅ 支援新舊料理名稱觸發（向下相容）

#### 5. 企劃書同步更新
- ✅ 更新版本至 V4.9
- ✅ 新增 V4.9 更新說明
- ✅ 更新 Day 3 最終料理說明
- ✅ 修正苦味結局的真相揭露文本

### 🔄 進行中
- [ ] LINE 實機測試 - 三種結局路線驗證

---

## 🎯 核心成就

### Day 3 三種料理對照

| 結局類型 | 料理名稱 | 視覺主題 | 顏色 |
|----------|----------|----------|------|
| 🍬 甜味過重 | 糖霜幻景拼盤 | 雪白糖粉、拼湊記憶 | #E91E63 粉紅 |
| 🦴 苦味過重 | 千針冷骨湯 | 冰冷黑湯、魚骨針刺 | #455A64 深灰藍 |
| 🐟 平衡 | 百味蜜汁炙燒魚 | 琥珀色、完整的魚 | #F57C00 溫暖橘 |

### 黑貓料理評論動態化

| 結局類型 | 黑貓台詞 |
|----------|----------|
| 甜味 | 「把所有甜的都拼在一起...再撒上糖粉...這是要騙誰呢？」 |
| 苦味 | 「肉都沒了，只剩下骨頭和刺。喝下去就像吞針一樣...這就是現實的味道嗎？」 |
| 平衡 | 「甜的、鹹的、酸的、苦的...這條魚裡什麼都有。這就是人生吧？趁熱吃。」 |

### 苦味獨白核心修正

**舊版**（違背職人設定）：
> 「我什麼都沒完成...」
> 「我沒有送出去...」
> 「對不起...爸爸什麼都沒做到...」

**新版**（職人的徒勞）：
> 「那件婚紗...真的很美。是我這輩子最好的作品。」
> 「但是...那又怎樣呢？」
> 「它現在躺在漆黑的櫃子裡。而我...倒在雪地裡。」
> 「沒人知道我做好了。也沒人會來穿它了。」

---

## 📊 代碼變更

### 修改函數（6 個）

| 函數名 | 行號 | 修改內容 |
|--------|------|----------|
| `getDay3CookingStart(state)` | L4043-4185 | 動態料理名稱、描述、按鈕、黑貓評論 |
| `handleDay3Cooking()` | L4189-4228 | 傳遞 state + 支援新料理名稱觸發 |
| `getDay3CookingProcess_Part1(state)` | L4230-4285 | 動態化料理演出（三種結局） |
| `getDay3CookingProcess_Part2(state)` | L4288-4338 | 動態化完成文案（三種結局） |
| `getDay3CookingMemoryCard(state)` | L4341-4427 | 動態黑貓評論 + 卡片顏色 |
| `getTruthMonologue("ENDING_BITTER")` | L4449-4478 | 職人的徒勞主題 |

### V4.10 修改函數（4 個 + 4 個呼叫處）

| 函數名 | 修改內容 |
|--------|----------|
| `getDay1CookingTea_Part1(state)` | 動態記憶顯示（針/縫線/寒冷/寧靜/陪伴） |
| `getDay1CookingSoup_Part1(state)` | 動態記憶顯示（雨聲/失憶/迷茫） |
| `getDay2CookingResult(state)` | 動態記憶顯示（移除寒冷） |
| `getDay2CookingResult_苦辛(state)` | 動態記憶顯示 + Flex Card |

### 代碼統計

- 總行數：6,160 行（+249 行）
- 版本號：V4.8 → V4.9 → V4.10
- 最後更新：2026-01-30

---

## 🔗 受影響的核心文件

- [[../../00-核心企劃/當前專案_靈魂食堂/靈魂食堂：最終開發執行企劃書]] - 更新至 V4.10，新增「五-A、料理食譜系統」章節
- [[主 Backlog_2026-01-15]] - 更新專案狀態至 V4.10
- [[../../README]] - 更新版本至 V4.10
- [[../../01-開發實驗/專案實作對照表]] - 更新最後更新日期至 V4.10

---

## 📚 相關文件

### 參考文件
- [[AI對談]] - Day 3 動態料理設計討論紀錄
- [[工作報告_2026-01-28_RichMenu_UX系統完成]] - 前一日工作（V4.8）

---

## 🧪 待執行測試

### 測試案例 1：甜味結局路線
**建議收集路線**：
- Day 1：沉默陪伴（寧靜、陪伴）
- Day 2：那個夢完整（蜜糖笑容、美雪的笑容、第一次叫爸爸）

**驗證項目**：
- [x] Day 3 廚房顯示「🍬 糖霜幻景拼盤」
- [x] 料理演出文案符合「拼盤」主題
- [x] 黑貓台詞正確

### 測試案例 2：苦味結局路線
**建議收集路線**：
- Day 1：你的手（針、縫線、寒冷）、你從哪裡來（失憶、迷茫）
- Day 2：你在找什麼（執念）、你怎麼來的（雪、死亡）

**驗證項目**：
- [x] Day 3 廚房顯示「🦴 千針冷骨湯」
- [x] 真相揭露為新版「職人的徒勞」
- [x] 黑貓台詞正確

### 測試案例 3：平衡結局路線
**建議收集路線**：
- Day 1：你的手（針、縫線、寒冷、裁縫手藝）
- Day 2：那個夢完整 + 你怎麼來的

**驗證項目**：
- [x] Day 3 廚房顯示「🐟 百味蜜汁炙燒魚」
- [x] 料理演出文案符合「炙燒魚」主題
- [x] 黑貓台詞正確

### LINE 測試指令
```
重新開始              → 重置遊戲
/debug phase         → 查看當前階段
/debug status        → 查看五味狀態
/debug setphase 3 cooking → 跳到 Day 3 料理階段
```

---

## 🎯 下一步行動

### 立即行動
1. **執行三種結局路線測試** - 驗證動態料理系統
2. **修正測試中發現的問題** - 如有 Bug 立即修復

### 短期計劃（本週）
1. 完成測試後更新本報告狀態
2. 準備 Guest 2 劇本開發

---

**報告人**：AI Assistant  
**報告時間**：2026-01-29 ~ 01-30  
**狀態**：🔄 已部署，待測試  
**版本**：V4.10（Day 1-3 料理演出動態化）

#tier2/追蹤
