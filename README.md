# 🍽️ 靈魂食堂（Soul Cafeteria）

> **專案代號**：CONFITEOR  
> **當前版本**：V4.13  
> **專案狀態**：✅ V4.13 LIFF 做飯小遊戲 MVP + 遺物圖片整合完成（2026-02-03）  
> **專案類型**：LINE OA 文字敘事遊戲

---

## 🎯 專案簡介

**靈魂食堂**是一款基於 LINE Official Account 的文字敘事遊戲。玩家扮演「罪名吞噬者（Sin-Eater）」，經營一間位於生死交界的邊境食堂，透過五味診斷與料理救贖幫助困於執念的靈魂超渡。

### 核心特色
- 🎭 **五味考古系統**：透過中醫五行理論映射情緒與記憶
- 📖 **標籤驅動敘事**：玩家選擇影響劇情分支，收集標籤解鎖隱藏劇情
- ⏳ **跨日鎖定機制**：3 日儀式流程，強制懸念與情感沉澱
- 💰 **零成本運營**：Reply API + Google Sheets，無需伺服器與資料庫
- 🎨 **情感優先設計**：參考《Bird Alone》《Bear's Restaurant》的敘事設計

---

## 📂 專案結構

```
SideProject/
├── 00-核心企劃/              # 企劃文件與世界觀設定
│   ├── 當前專案_靈魂食堂/
│   │   ├── 靈魂食堂：最終開發執行企劃書.md  ⭐ SSOT 唯一真理
│   │   └── 靈魂食堂企劃：料理與救贖.md
│   ├── 開發決策鏈.md          # V1.0 → V4.x 的決策邏輯
│   └── 歷史歸檔_V1.0-V1.3/   # 舊版企劃（雲寶時代）
│
├── 01-開發實驗/              # 程式碼與技術文件
│   ├── 程式碼/
│   │   ├── 靈魂食堂_田中太郎_五味料理版.gs  ⭐ 主代碼（V4.13）
│   │   ├── config.template.gs
│   │   ├── 部署與開發指南.md                ⭐ 整合版部署指南
│   │   ├── 田中太郎版部署指南.md
│   │   ├── 敏感文件同步指南.md
│   │   ├── 測試路線表_田中太郎.md
│   │   ├── 重構驗證報告_2026-01-16.md
    │   │   └── archive-versions/                # 重構版、畫鬼腳等歷史版（已從 git 移除）
│   └── 專案實作對照表.md      # 技術規格手冊
│
├── 02-劇本設計/              # 劇本與敘事設計
│   ├── Guest1_田中太郎_重構版_神秘感優先.md  ⭐ 當前劇本（MVP v3.0）
│   ├── 田中太郎_人生紀實.md           # 完整人生故事（企劃參考）
│   ├── 田中太郎_人生紀實_前篇.md      # 甜味結局解鎖：銀座的驕傲
│   ├── 田中太郎_人生紀實_中篇.md      # 苦味結局解鎖：缺席的典禮
│   ├── 田中太郎_人生紀實_後篇.md      # 平衡結局解鎖：最後一針
│   ├── 田中太郎_人生紀實整合建議.md
│   ├── 田中太郎劇情流程圖.md
│   ├── 靈魂考古_3日邏輯鏈.md
│   └── archive-versions/                    # MVP 擴充版等歸檔
│
├── 02-研究分析/              # 競品分析與理論研究
│   ├── 靈魂食堂企劃重構.md
│   ├── Line OA 文字遊戲 MVP 開發指南.md
│   ├── 靈魂告解食堂 遊戲概念延伸.md
│   ├── 遊戲解構與融合設計建議.md
│   ├── 企劃書與Bird Alone結合探討.md
│   ├── 孤鳥劇情解析與文字遊戲發想.md
│   ├── 紅弦俱樂部劇情攻略與分析.md
│   └── archive-research/                    # 雲寶時代研究歸檔
│
├── 03-驗證流程/
│   ├── 驗證流程總覽.md
│   └── 驗證記錄.md
│
├── 04-資源素材/
│   ├── 產品規劃轉變脈絡_從雲寶到靈魂食堂.md
│   ├── 技術成本_非即時制設計的優勢.md
│   ├── 敘事機制_載體與體驗的裂縫.md
│   ├── 開發哲學_成本優先原則.md
│   └── 圖片/
│
└── 00-工作區/                # 進度管理與報告
    ├── 主 Backlog_2026-01-15.md
    ├── 工作報告_2026-01-26_劇本昇華三痛點完成.md
    ├── 工作報告_2026-01-27_結局變體系統完成.md
    ├── 工作報告_2026-02-02_Hero圖整合完成.md  ⭐ 最新
    └── archive-2026-01/                       # 1月份舊報告歸檔
```

**說明**：以上以 2026-01-28 實際目錄為準。歷史版本與舊報告見各 `archive-versions`、`archive-2026-01`。

---

## 🚀 快速開始

### 🆕 新手入門（5 分鐘理解專案）

**必讀順序**：
1. 🎭 [靈魂食堂：最終開發執行企劃書](00-核心企劃/當前專案_靈魂食堂/靈魂食堂：最終開發執行企劃書.md) - 完整世界觀與機制
2. 📖 [專案架構報告](.cursor/PROJECT_ARCHITECTURE.md) - 理解專案文件結構與 Tier 系統
3. 📜 [Guest1 田中太郎劇本](02-劇本設計/Guest1_田中太郎_重構版_神秘感優先.md) - 看實際範例

### 👨‍💻 開發者快速上手

**部署流程**：
1. 閱讀 [部署與開發指南](01-開發實驗/程式碼/部署與開發指南.md)（或 [田中太郎版部署指南](01-開發實驗/程式碼/田中太郎版部署指南.md)）
2. 複製 `靈魂食堂_田中太郎_五味料理版.gs` 到 Google Apps Script
3. 設定 Google Sheets（參考 [專案實作對照表](01-開發實驗/專案實作對照表.md)）
4. 依劇本與 [測試路線表](01-開發實驗/程式碼/測試路線表_田中太郎.md) 驗證流程
5. 在 LINE OA 測試 `/debug state`

### 🎨 企劃/編劇上手

**劇本創作流程**：
1. 閱讀 [靈魂考古_3日邏輯鏈](02-劇本設計/靈魂考古_3日邏輯鏈.md)
2. 參考 [Guest1 田中太郎劇本](02-劇本設計/Guest1_田中太郎_重構版_神秘感優先.md) 的結構
3. 設計角色的「執念」與「目標料理」
4. 建立標籤系統與分支對話
5. 填入 Google Sheets 的 `dialogueLibrary`

---

## 📊 專案進度

### ✅ 已完成（V4.13 - 2026-02-03）

**核心系統**：
- ✅ 核心架構重構（8 欄單表結構：userStateTanaka）
- ✅ UX 全面改進（Loading Animation + 訊息分段）
- ✅ 玩家輸入系統（Message Action 綠色對話泡泡）
- ✅ Day 1–3 動態話題系統（多路徑探索 + 延伸話題）
- ✅ 五味數值系統 + 三種結局（甜味過重/苦味過重/平衡）
- ✅ Guest 1「田中太郎」劇本完整實作並測試成功

**V4.5-V4.13 新功能**：
- ✅ **V4.5 劇本昇華三痛點**：翻譯者概念（失語）、裂痕事件（缺席的典禮）、時代孤獨（空蕩的店）
- ✅ **V4.6 結局變體系統**：18 種結局名稱/黑貓評論/遺物描述動態化
- ✅ **V4.7 敘事修復與圖鑑系統**：lifetimeHeirlooms 永久遺物、真相揭露修復
- ✅ **V4.8 Rich Menu UX 系統**：分級管制 + 回程票 + 靈魂狀態面板
- ✅ **V4.10 料理演出動態化**：Day 1-3 料理演出根據實際收集記憶顯示
- ✅ **V4.11 Hero 圖整合**：11 張記憶碎片/劇場 Hero 圖（Hollow Knight 風格）
- ✅ **V4.12 Day 3 告別 Hero 圖**：3 張結局 Hero 圖（苦味/甜味/平衡），共 14 張
- ✅ **V4.13 LIFF + 遺物圖片**：LIFF 做飯小遊戲 MVP、遺物圖鑑改用圖片（3 張）

### 🔄 進行中

- [ ] 收集玩家反饋（封閉測試）
- [ ] Guest 2 劇本撰寫

### 📋 計畫中

- [ ] LIFF 烹飪小遊戲（條件：50+ 玩家完成 Guest 1）
- [ ] 封閉測試（5-10 名玩家）
- [ ] 隱藏靈魂與元敘事

詳細進度：[主 Backlog](00-工作區/主 Backlog_2026-01-15.md)

---

## 🎯 核心機制說明

### 五味考古系統

| 五味 | 五行 | 治療情緒 | 遊戲作用 |
|------|------|---------|---------|
| 🍯 甜 | 土 | 焦慮 | 撫慰與接地 |
| 🍋 酸 | 木 | 悔恨 | 聚焦與收斂 |
| ☕ 苦 | 火 | 執念 | 清醒與瀉火 |
| 🌶️ 辣 | 金 | 悲傷 | 宣洩與流動 |
| 🧂 鹹 | 水 | 失憶 | 意志與記憶 |

### 三日儀式流程

```
Day 1: 誘捕（Lure）
  → 玩家透過互動收集感官標籤（溫暖、柔軟、鹹味等）
  → 靈魂的樣貌逐漸清晰

Day 2: 偵訊（Feast）
  → 標籤組合觸發記憶場景
  → 解鎖目標料理

Day 3: 赦免（Absolution）
  → 烹飪料理 → 記憶重現 → 告別儀式
  → 獲得遺物作為紀念
```

---

## 🛠️ 技術架構

### 技術棧
- **前端**：LINE Messaging API（文字 + Flex Message）
- **後端**：Google Apps Script（免費、無需伺服器）
- **資料庫**：Google Sheets（免費、視覺化、可人工檢查）
- **版控**：本地 Obsidian + Git

### 數據結構

**userStateTanaka Sheet（8 欄）**：
| 欄位 | 用途 |
|------|------|
| A: userId | LINE UID |
| B: currentDay | 當前天數 (1-3) |
| C: phase | 階段 (night/day/cooking/after) |
| D: collectedMemories | 已收集記憶 JSON Array |
| E: topicsDone | 已完成話題 JSON Array |
| F: lastActive | 最後活躍時間 |
| G: dishesCooked | 已做料理 JSON Array |
| H: lifetimeHeirlooms | 永久遺物記錄 JSON Object |

詳細規格：[專案實作對照表](01-開發實驗/專案實作對照表.md)

---

## 📚 設計理念

### 三大不變的底層規則

1. **低成本、非同步互動**
   - Reply API 免費（玩家主動觸發）
   - 無推播成本（跨日鎖定取代推播）
   - Google Sheets 免費資料庫

2. **高情感投入**
   - 3 日濃縮《Bird Alone》的情感曲線
   - 「見證而非審判」的敘事範式
   - 告別儀式帶來的失落感與完成感

3. **文字作為核心媒介**
   - 標籤驅動對話系統
   - 對話選擇影響劇情分支
   - 留白與想像的美學

詳細決策邏輯：[產品規劃轉變脈絡](04-資源素材/產品規劃轉變脈絡_從雲寶到靈魂食堂.md)

---

## 🎨 參考作品

- **《Bird Alone》**：情感曲線、告別機制、非同步互動
- **《Bear's Restaurant》**：料理喚起記憶的核心設計
- **《Spiritfarer》**：靈魂擺渡、告別儀式的儀式感
- **《黃昏旅店》**：生死交界的世界觀設定
- **《To the Moon》**：記憶重組的敘事手法
- **中醫五行理論**：五味與情緒的映射系統

---

## 📖 關鍵文件索引

### 給新手
- 🎭 [靈魂食堂：最終開發執行企劃書](00-核心企劃/當前專案_靈魂食堂/靈魂食堂：最終開發執行企劃書.md)
- 📐 [專案架構報告](.cursor/PROJECT_ARCHITECTURE.md)（Tier 系統與文件結構）
- 📜 [Guest1 田中太郎劇本](02-劇本設計/Guest1_田中太郎_重構版_神秘感優先.md)

### 給開發者
- 📋 [專案實作對照表](01-開發實驗/專案實作對照表.md)
- 🚀 [部署與開發指南](01-開發實驗/程式碼/部署與開發指南.md)
- 🧪 [測試路線表](01-開發實驗/程式碼/測試路線表_田中太郎.md)

### 給企劃/編劇
- 📖 [靈魂考古_3日邏輯鏈](02-劇本設計/靈魂考古_3日邏輯鏈.md)
- 📜 [Guest1 田中太郎劇本](02-劇本設計/Guest1_田中太郎_重構版_神秘感優先.md)
- 📊 [田中太郎_橫向與五味結構](00-核心企劃/當前專案_靈魂食堂/田中太郎_橫向與五味結構.md)
- 🧠 [開發決策鏈](00-核心企劃/開發決策鏈.md)

### 進度管理
- 📅 [主 Backlog](00-工作區/主 Backlog_2026-01-15.md)
- 📊 [最新工作報告](00-工作區/工作報告_2026-02-02_Hero圖整合完成.md)
- 📋 [驗證流程總覽](03-驗證流程/驗證流程總覽.md)
- 📝 [驗證記錄](03-驗證流程/驗證記錄.md)

---

## 🤝 參與貢獻

### 我可以做什麼？

- **撰寫新靈魂劇本**：參考 Guest1 的結構創作新角色
- **設計 Flex Message**：為靈魂設計視覺卡片
- **參與封閉測試**：體驗遊戲並提供反饋
- **優化現有劇本**：改進對話與分支設計

### 如何開始？

1. 閱讀核心文件理解專案
2. 在 [主 Backlog](00-工作區/主 Backlog_2026-01-15.md) 查看待辦任務
3. 選擇一個任務開始貢獻
4. 提交你的作品或回饋

---

## 📞 聯絡方式

**專案負責人**：開發者  
**最後更新**：2026-02-02  
**下次回顧**：2026-02-09

---

## 📄 授權

**目前狀態**：私人專案（未開源）  
**未來計畫**：完成 MVP 驗證後考慮開源

---

**Let's save some souls. 🍽️✨**

